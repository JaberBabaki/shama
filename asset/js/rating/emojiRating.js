$(document).ready(function() {
    $("#psychRatingEmoji li:nth-child(1)").hover(function() {
        $("#psychRatingDot").css("margin-left", "0px");
        alert("first");

        function explode() {
            $("#psychRatingEmoji li:nth-child(1) img").attr("src", "/asset/image/emojis/emoji1.png");
            $("#psychRatingEmoji li:nth-child(2) img").attr("src", "/asset/image/emojis/emoji22.png");
            $("#psychRatingEmoji li:nth-child(3) img").attr("src", "/asset/image/emojis/emoji33.png");
            $("#psychRatingEmoji li:nth-child(4) img").attr("src", "/asset/image/emojis/emoji44.png");
            $("#psychRatingEmoji li:nth-child(5) img").attr("src", "/asset/image/emojis/emoji55.png");
            $("#psychRatingNote li:nth-child(1)").css("color", "black");
            $("#psychRatingNote li:nth-child(2)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(3)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(4)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(5)").css("color", "#3A6D88");
        }
        setTimeout(explode, 300);
    });
    $("#psychRatingEmoji li:nth-child(2)").hover(function() {
        $("#psychRatingDot").css("margin-left", "60px");

        function explode() {
            $("#psychRatingEmoji li:nth-child(1) img").attr("src", "/asset/image/emojis/emoji11.png");
            $("#psychRatingEmoji li:nth-child(2) img").attr("src", "/asset/image/emojis/emoji2.png");
            $("#psychRatingEmoji li:nth-child(3) img").attr("src", "/asset/image/emojis/emoji33.png");
            $("#psychRatingEmoji li:nth-child(4) img").attr("src", "/asset/image/emojis/emoji44.png");
            $("#psychRatingEmoji li:nth-child(5) img").attr("src", "/asset/image/emojis/emoji55.png");
            $("#psychRatingNote li:nth-child(1)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(2)").css("color", "black");
            $("#psychRatingNote li:nth-child(3)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(4)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(5)").css("color", "#3A6D88");
        }
        setTimeout(explode, 300);
    });
    $("#psychRatingEmoji li:nth-child(3)").hover(function() {
        $("#psychRatingDot").css("margin-left", "120px");

        function explode() {
            $("#psychRatingEmoji li:nth-child(1) img").attr("src", "/asset/image/emojis/emoji11.png");
            $("#psychRatingEmoji li:nth-child(2) img").attr("src", "/asset/image/emojis/emoji22.png");
            $("#psychRatingEmoji li:nth-child(3) img").attr("src", "/asset/image/emojis/emoji3.png");
            $("#psychRatingEmoji li:nth-child(4) img").attr("src", "/asset/image/emojis/emoji44.png");
            $("#psychRatingEmoji li:nth-child(5) img").attr("src", "/asset/image/emojis/emoji55.png");
            $("#psychRatingNote li:nth-child(1)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(2)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(3)").css("color", "black");
            $("#psychRatingNote li:nth-child(4)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(5)").css("color", "#3A6D88");
        }
        setTimeout(explode, 300);
    });
    $("#psychRatingEmoji li:nth-child(4)").hover(function() {
        $("#psychRatingDot").css("margin-left", "180px");

        function explode() {
            $("#psychRatingEmoji li:nth-child(1) img").attr("src", "/asset/image/emojis/emoji11.png");
            $("#psychRatingEmoji li:nth-child(2) img").attr("src", "/asset/image/emojis/emoji22.png");
            $("#psychRatingEmoji li:nth-child(3) img").attr("src", "/asset/image/emojis/emoji33.png");
            $("#psychRatingEmoji li:nth-child(4) img").attr("src", "/asset/image/emojis/emoji4.png");
            $("#psychRatingEmoji li:nth-child(5) img").attr("src", "/asset/image/emojis/emoji55.png");
            $("#psychRatingNote li:nth-child(1)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(2)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(3)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(4)").css("color", "black");
            $("#psychRatingNote li:nth-child(5)").css("color", "#3A6D88");
        }
        setTimeout(explode, 300);
    });
    $("#psychRatingEmoji li:nth-child(5)").hover(function() {
        $("#psychRatingDot").css("margin-left", "240px");

        function explode() {
            $("#psychRatingEmoji li:nth-child(1) img").attr("src", "/asset/image/emojis/emoji11.png");
            $("#psychRatingEmoji li:nth-child(2) img").attr("src", "/asset/image/emojis/emoji22.png");
            $("#psychRatingEmoji li:nth-child(3) img").attr("src", "/asset/image/emojis/emoji33.png");
            $("#psychRatingEmoji li:nth-child(4) img").attr("src", "/asset/image/emojis/emoji44.png");
            $("#psychRatingEmoji li:nth-child(5) img").attr("src", "/asset/image/emojis/emoji5.png");
            $("#psychRatingNote li:nth-child(1)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(2)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(3)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(4)").css("color", "#3A6D88");
            $("#psychRatingNote li:nth-child(5)").css("color", "black");
        }
        setTimeout(explode, 300);
    });

    ////////////////

    $("#counselingRatingEmoji li:nth-child(1)").hover(function() {
        $("#counselingRatingDot").css("margin-left", "0px");

        function explode() {
            $("#counselingRatingEmoji li:nth-child(1) img").attr("src", "/asset/image/emojis/emoji1.png");
            $("#counselingRatingEmoji li:nth-child(2) img").attr("src", "/asset/image/emojis/emoji22.png");
            $("#counselingRatingEmoji li:nth-child(3) img").attr("src", "/asset/image/emojis/emoji33.png");
            $("#counselingRatingEmoji li:nth-child(4) img").attr("src", "/asset/image/emojis/emoji44.png");
            $("#counselingRatingEmoji li:nth-child(5) img").attr("src", "/asset/image/emojis/emoji55.png");
            $("#counselingRatingNote li:nth-child(1)").css("color", "black");
            $("#counselingRatingNote li:nth-child(2)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(3)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(4)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(5)").css("color", "#3A6D88");
        }
        setTimeout(explode, 300);
    });
    $("#counselingRatingEmoji li:nth-child(2)").hover(function() {
        $("#counselingRatingDot").css("margin-left", "60px");

        function explode() {
            $("#counselingRatingEmoji li:nth-child(1) img").attr("src", "/asset/image/emojis/emoji11.png");
            $("#counselingRatingEmoji li:nth-child(2) img").attr("src", "/asset/image/emojis/emoji2.png");
            $("#counselingRatingEmoji li:nth-child(3) img").attr("src", "/asset/image/emojis/emoji33.png");
            $("#counselingRatingEmoji li:nth-child(4) img").attr("src", "/asset/image/emojis/emoji44.png");
            $("#counselingRatingEmoji li:nth-child(5) img").attr("src", "/asset/image/emojis/emoji55.png");
            $("#counselingRatingNote li:nth-child(1)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(2)").css("color", "black");
            $("#counselingRatingNote li:nth-child(3)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(4)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(5)").css("color", "#3A6D88");
        }
        setTimeout(explode, 300);
    });
    $("#counselingRatingEmoji li:nth-child(3)").hover(function() {
        $("#counselingRatingDot").css("margin-left", "120px");

        function explode() {
            $("#counselingRatingEmoji li:nth-child(1) img").attr("src", "/asset/image/emojis/emoji11.png");
            $("#counselingRatingEmoji li:nth-child(2) img").attr("src", "/asset/image/emojis/emoji22.png");
            $("#counselingRatingEmoji li:nth-child(3) img").attr("src", "/asset/image/emojis/emoji3.png");
            $("#counselingRatingEmoji li:nth-child(4) img").attr("src", "/asset/image/emojis/emoji44.png");
            $("#counselingRatingEmoji li:nth-child(5) img").attr("src", "/asset/image/emojis/emoji55.png");
            $("#counselingRatingNote li:nth-child(1)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(2)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(3)").css("color", "black");
            $("#counselingRatingNote li:nth-child(4)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(5)").css("color", "#3A6D88");
        }
        setTimeout(explode, 300);
    });
    $("#counselingRatingEmoji li:nth-child(4)").hover(function() {
        $("#counselingRatingDot").css("margin-left", "180px");

        function explode() {
            $("#counselingRatingEmoji li:nth-child(1) img").attr("src", "/asset/image/emojis/emoji11.png");
            $("#counselingRatingEmoji li:nth-child(2) img").attr("src", "/asset/image/emojis/emoji22.png");
            $("#counselingRatingEmoji li:nth-child(3) img").attr("src", "/asset/image/emojis/emoji33.png");
            $("#counselingRatingEmoji li:nth-child(4) img").attr("src", "/asset/image/emojis/emoji4.png");
            $("#counselingRatingEmoji li:nth-child(5) img").attr("src", "/asset/image/emojis/emoji55.png");
            $("#counselingRatingNote li:nth-child(1)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(2)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(3)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(4)").css("color", "black");
            $("#counselingRatingNote li:nth-child(5)").css("color", "#3A6D88");
        }
        setTimeout(explode, 300);
    });
    $("#counselingRatingEmoji li:nth-child(5)").hover(function() {
        $("#counselingRatingDot").css("margin-left", "240px");

        function explode() {
            $("#counselingRatingEmoji li:nth-child(1) img").attr("src", "/asset/image/emojis/emoji11.png");
            $("#counselingRatingEmoji li:nth-child(2) img").attr("src", "/asset/image/emojis/emoji22.png");
            $("#counselingRatingEmoji li:nth-child(3) img").attr("src", "/asset/image/emojis/emoji33.png");
            $("#counselingRatingEmoji li:nth-child(4) img").attr("src", "/asset/image/emojis/emoji44.png");
            $("#counselingRatingEmoji li:nth-child(5) img").attr("src", "/asset/image/emojis/emoji5.png");
            $("#counselingRatingNote li:nth-child(1)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(2)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(3)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(4)").css("color", "#3A6D88");
            $("#counselingRatingNote li:nth-child(5)").css("color", "black");
        }
        setTimeout(explode, 300);
    });


    ///////


});


var baseURL = "<?php echo baseUrl(); ?>";
var appointment_id;
var paymentMode;
// var appointment_id = document.getElementById('nearest-appointment').getAttribute('value');
// $('#nearest-appointment').click(function(){
function runRatingDialog(_appointment_id) {
    appointment_id = _appointment_id;
    $('#cancelDialog').modal('show');
    var formData = new FormData();
    formData.append('appointment_id', appointment_id);
    jQuery.ajax({
        url: baseURL + '/userCommon/appointmentInfo',
        type: 'POST',
        dataType: 'JSON',
        data: formData,
        contentType: false,
        processData: false,
        success: function(result) {
            var json = result;
            if (json.Status == true) {
                paymentSteps(json);
            }
        }
    });
}

function paymentSteps(json) {
    var counselingName = json.counselingName;
    var psychName = json.psychName;
    var startTime = json.startTime;
    var endTime = json.endTime;
    var date = json.date;
    var day = json.day;
    paymentMode = json.paymentMode;
    var weekDay = new Array(7);
    weekDay[0] = "یکشنبه";
    weekDay[1] = "دوشنبه";
    weekDay[2] = "سه شنبه";
    weekDay[3] = "چهار شنبه";
    weekDay[4] = "پنجشنبه";
    weekDay[5] = "جمعه";
    weekDay[6] = "شنبه";
    $("#psychRatingTxt").html("<div>" + "میزان رضایت از دکتر " + psychName + "</div>");

    $("#counselingRatingTxt").html("<div>" + " میزان رضایت از درمانگاه " + counselingName + "</div>");

    $('#cancel').click(function() {
        $('#cancelDialog').modal('hide');
    });

    $('#verify').click(function() {
        $('#verifyBox').hide(400);
        if (paymentMode == 2) {
            $('#payInfo').show(1000);
        } else {
            var formData = new FormData();
            formData.append('name', '');
            formData.append('cardNum', '');
            formData.append('appointment_id', appointment_id);
            var jsonData;
            $.ajax({
                url: baseURL + '/user1/cancelAppointment',
                type: 'POST',
                dataType: 'JSON',
                data: formData,
                contentType: false,
                processData: false,
                success: function(result) {
                    jsonData = result;
                    if (jsonData.Status == true) {
                        $('#cancelDialog').modal('hide');

                        Swal.fire({
                            type: 'success',
                            position: 'top',
                            title: 'نوبت شما با موفقیت لغو شد',
                            text: 'مبلغ تا ۲۴ ساعت آینده به حساب شما انتقال داده می شود',
                            showConfirmButton: false,
                            timer: 3000,
                            onClose: () => {
                                location.reload(true)
                            }
                        });
                    } else {
                        Swal.fire({
                            type: 'error',
                            position: 'top',
                            title: 'مجددا تلاش کنید',
                            showConfirmButton: false,
                            timer: 6000,
                            onClose: location.reload(true),
                        });
                    }

                }
            });
        }
    });
}





$('#cancelBtn').click(function() {
    $('#cancelDialog').modal('hide');
});

// function submitCancel(){
$('#verifyBtn').click(function() {
    var cardNum = document.getElementById("cardNum").value;
    var name = document.getElementById("name").value;
    status1 = checkCardNum(cardNum);
    status2 = checkName(name);
    if (status1 == true && status2 == true) {
        var formData = new FormData();
        formData.append('name', name);
        formData.append('cardNum', cardNum);
        formData.append('appointment_id', appointment_id);
        var jsonData;
        $.ajax({
            url: baseURL + '/user1/cancelAppointment',
            type: 'POST',
            dataType: 'JSON',
            data: formData,
            contentType: false,
            processData: false,
            success: function(result) {
                jsonData = result;
                if (jsonData.Status == true) {
                    $('#cancelDialog').modal('hide');

                    Swal.fire({
                        type: 'success',
                        position: 'top',
                        title: 'نوبت شما با موفقیت لغو شد',
                        text: 'مبلغ تا ۲۴ ساعت آینده به حساب شما انتقال داده می شود',
                        showConfirmButton: false,
                        timer: 3000,
                        onClose: () => {
                            location.reload(true)
                        }
                    });
                } else {
                    Swal.fire({
                        type: 'error',
                        position: 'top',
                        title: 'مجددا تلاش کنید',
                        showConfirmButton: false,
                        timer: 6000,
                        onClose: location.reload(true),
                    });
                }

            }
        });
    }
});

function checkCardNum(cardNum) {
    var status = true;
    if (cardNum.length != 16 && cardNum.length != 0) {
        $("#validCardNum").css({ "display": "block", "color": "red" });
        $("#validCardNum").text(" شماره کارت وارد شده صحیح نیست");
        status = false;
    } else if (cardNum.length == 0) {
        $("#validCardNum").css({ "display": "block", "color": "red" });
        $("#validCardNum").text("لطفا شماره کارت را وارد کنید");
        status = false;
    } else {
        $("#validCardNum").css({ "display": "none" });
        $("#validCardNum").text("");
        status = true;
    }
    return status;
}

function checkName(name) {
    var status = true;
    if (name.length == 0) {
        $("#validName").css({ "display": "block", "color": "red" });
        $("#validName").text("لطفا نام و نام خانوادگی خود را وارد کنید");
        status = false;
    } else if (name.split(' ').length == 1) {
        $("#validName").css({ "display": "block", "color": "red" });
        $("#validName").text("نام یا نام خانوادگی وارد نشده است");
        status = false;
    } else {
        $("#validName").css({ "display": "none" });
        $("#validName").text("");
        status = true;
    }
    return status;
}